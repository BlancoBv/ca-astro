---
import Layout from "@layouts/Layout.astro";
import BadgeEtiquetas from "@components/badge/BadgeEtiquetas.astro";
import { Image } from "astro:assets";
import EtiquetasHeading from "@components/gui/EtiquetasHeading.astro";

const { origin } = Astro.url;
const { id } = Astro.params;

const blog = await fetch(`${origin}/api/blogs?idblog=${id}`).then((res) =>
  res.json()
);

if (!blog) {
  return Astro.redirect("/404");
}
---

<Layout title={blog.response.titulo}>
  <main class="prose max-w-full p-4">
    <h1>{blog.response.titulo}</h1>
    <Image
      transition:name={`img-${id}`}
      class="object-contain lg:object-cover aspect-video h-96 lg:h-[500px] w-full revealing-image rounded-box"
      src={blog.response.imagen}
      width={100}
      height={100}
      loading="lazy"
      alt={blog.response.titulo}
    />
    <div set:html={blog.response.contenido} />
    <EtiquetasHeading />
    <div class="flex gap-4 flex-wrap not-prose">
      {
        blog.response.etiquetas.map((el: any) => (
          <BadgeEtiquetas
            nombre={el.nombre}
            ruta={`/content/eventos/${el.idetiqueta}`}
          />
        ))
      }
    </div>
  </main>
</Layout>
<style>
  @keyframes reveal {
    from {
      opacity: 0;
      clip-path: inset(45% 20% 45% 20%);
    }
    to {
      opacity: 1;
      clip-path: inset(0% 0% 0% 0%);
    }
  }
  .revealing-image {
    /* Create View Timeline */
    view-timeline-name: --revealing-image;
    view-timeline-axis: block;

    /* Attach animation, linked to the  View Timeline */
    animation: linear reveal both;
    animation-timeline: --revealing-image;

    /* Tweak range when effect should run*/
    animation-range: entry 25% cover 50%;
  }

  /*   @keyframes reveal-header {
    from {
      height: 100vh;
    }
    to {
      opacity: 1;
      height: 10vh;
    }
  }
  .header-image {
    view-timeline-name: --revealing-image;
    view-timeline-axis: block;

    animation: linear reveal-header both;
    animation-timeline: --revealing-image;

    animation-range: entry 0% cover 80%;
  } */
</style>
