import{d as C,r as y,z as D,j as F,o as l,c as r,a as n,u as _,F as x,t as g,x as S,b as R,v as B,A as I,y as k,w as U,f as N,B as A}from"./index.CYdWx_fJ.js";import j from"./Editor.CGjhJnPw.js";import{a as P,u as T}from"./http.CGtWncCw.js";import{_ as O}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./utils.O0ez53dv.js";const L=C({__name:"SelectRuta",props:{value:{},required:{type:Boolean}},emits:["setOption"],setup(v,{expose:a,emit:p}){a();const e=v,u=y(e.value),o=p,t=y(!1),d=y({subrutas:[],rutaBase:""}),h=D("input-ruta"),{data:i,isError:b,isPending:w}=P("menus","rutasData"),q=s=>{u.value=s,o("setOption",s)};F(u,(s,m)=>{if(console.log({value:s,oldValue:m}),!b.value&&!w.value){const f=i.value.response?.findIndex(V=>V.ruta===s),E=i.value.response[f];E&&E?.dropcollapse?(t.value=!0,d.value={rutaBase:s,subrutas:E.submenus}):(t.value=!1,d.value={rutaBase:"",subrutas:[]})}});const c={props:e,ruta:u,emit:o,haveRoutes:t,subRoutes:d,inputRuta:h,data:i,isError:b,isPending:w,handleChange:q};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),z=["value"],M={selected:"",disabled:"",value:""},G=["value"],H=["value"],J=["value"];function K(v,a,p,e,u,o){return l(),r(x,null,[n("select",{class:"select select-bordered w-full max-w-xs",value:e.ruta,onInput:a[0]||(a[0]=t=>e.handleChange(t.target.value)),required:"",ref:"input-ruta"},[n("option",M,_(e.isPending?"Cargando...":"Seleccione una ruta"),1),!e.isPending&&!e.isError?(l(!0),r(x,{key:0},g(e.data.response,t=>(l(),r("option",{value:t.ruta},_(t.nombre),9,G))),256)):S("",!0)],40,z),e.haveRoutes?(l(),r("select",{key:0,class:"select select-bordered w-full max-w-xs",value:e.props.value,onInput:a[1]||(a[1]=t=>e.emit("setOption",t.target.value)),required:""},[a[2]||(a[2]=n("option",{selected:"",disabled:"",value:""},"Seleccione una ruta",-1)),!e.isPending&&!e.isError?(l(!0),r(x,{key:0},g(e.subRoutes.subrutas,t=>(l(),r("option",{value:e.subRoutes.rutaBase+"/"+t.ruta},_(t.nombre),9,J))),256)):S("",!0)],40,H)):S("",!0)],64)}const Q=O(L,[["render",K]]),W=C({__name:"SelectEtiqueta",props:{value:{},required:{type:Boolean}},emits:["setOption"],setup(v,{expose:a,emit:p}){a();const e=v,u=p,o=y([]),{data:t,isError:d,isPending:h}=P("etiquetas","etiquetasData"),i=y([]),q={props:e,emit:u,values:o,data:t,isError:d,isPending:h,defaultLabels:i,handleClick:c=>{if(o.value=[...o.value,{id:c.idetiqueta,label:c.nombre}],u("setOption",o.value),i.value.length<1){const s=[...t.value.response],m=s.findIndex(f=>f.idetiqueta===c.idetiqueta);s.splice(m,1),i.value=s}else{const s=[...i.value],m=s.findIndex(f=>f.idetiqueta===c.idetiqueta);s.splice(m,1),i.value=s}},deleteEtiqueta:c=>{const s=[...o.value],m=[...t.value.response].findIndex(f=>f.idetiqueta===s[c].id);i.value=[...i.value,t.value.response[m]],s.splice(c,1),o.value=s,u("setOption",o.value)}};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),X={class:"flex gap-4 items-center"},Y={class:"border border-base-content/20 rounded-box h-20 flex-grow gap-4 p-2 flex flex-wrap overflow-y-auto"},Z={key:0,class:"badge badge-primary"},$=["onClick"],ee={class:"dropdown"},te={class:"menu dropdown-content bg-base-100 rounded-box z-50 w-52 p-2 shadow"},ae=["onClick"],ne=["onClick"];function se(v,a,p,e,u,o){return l(),r("div",null,[a[1]||(a[1]=n("label",null,"Etiquetas",-1)),n("div",X,[n("div",Y,[e.values.length<1?(l(),r("span",Z,"¡Añade algunas etiquetas!")):(l(!0),r(x,{key:1},g(e.values,(t,d)=>(l(),r("div",{class:"badge badge-primary cursor-pointer hover:badge-error",onClick:h=>e.deleteEtiqueta(d)},_(t.label),9,$))),256))]),n("details",ee,[a[0]||(a[0]=n("summary",{class:"btn m-1"},"Añadir etiquetas",-1)),n("ul",te,[!e.isPending&&!e.isError&&e.values.length<1?(l(!0),r(x,{key:0},g(e.data.response,t=>(l(),r("li",null,[n("button",{type:"button",onClick:d=>e.handleClick(t)},_(t.nombre),9,ae)]))),256)):(l(!0),r(x,{key:1},g(e.defaultLabels,t=>(l(),r("li",null,[n("button",{type:"button",onClick:d=>e.handleClick(t)},_(t.nombre),9,ne)]))),256))])])])])}const oe=O(W,[["render",se]]),le=C({__name:"AddArticulo",props:{idUsuario:{}},setup(v,{expose:a}){a();const p=v,e=N({titulo:"",ruta:"",idUsuario:p.idUsuario,fecha:"",etiquetas:[]}),u=b=>{e.contenido=b},o=b=>{e.ruta=b},t=b=>{e.etiquetas=b},d=T("articulos","post"),i={props:p,body:e,handleEditor:u,handleRuta:o,handleEtiquetas:t,send:d,handleSubmit:()=>{e:{if(!e.contenido){A.warning("No has escrito nada en el editor.");break e}if(e.etiquetas.length<1){A.error("Añade al menos una etiqueta.");break e}d.mutate(e)}},Editor:j,SelectRuta:Q,SelectEtiqueta:oe};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),re={class:"form-control w-full max-w-xs"},ie={class:"form-control w-full max-w-xs"};function ue(v,a,p,e,u,o){return l(),r("form",{onSubmit:U(e.handleSubmit,["prevent"])},[n("label",re,[a[2]||(a[2]=n("div",{class:"label"},[n("span",{class:"label-text"},"Titulo del articulo")],-1)),R(n("input",{type:"text",class:"input input-bordered w-full max-w-xs",required:"","onUpdate:modelValue":a[0]||(a[0]=t=>e.body.titulo=t)},null,512),[[B,e.body.titulo]])]),n("label",ie,[a[3]||(a[3]=n("div",{class:"label"},[n("span",{class:"label-text"},"Fecha")],-1)),R(n("input",{type:"date",class:"input input-bordered w-full max-w-xs",required:"","onUpdate:modelValue":a[1]||(a[1]=t=>e.body.fecha=t)},null,512),[[B,e.body.fecha]])]),I(" "+_(e.body.ruta)+" ",1),k(e.SelectRuta,{value:e.body.ruta,onSetOption:e.handleRuta},null,8,["value"]),k(e.SelectEtiqueta,{value:e.body.etiquetas,onSetOption:e.handleEtiquetas},null,8,["value"]),k(e.Editor,{onUpdateContent:e.handleEditor}),a[4]||(a[4]=n("button",{class:"btn btn-primary",type:"submit"},"Enviar",-1))],32)}const me=O(le,[["render",ue]]);export{me as default};
