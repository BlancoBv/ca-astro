import{d as B,c as k,m as d,a as o,k as V,q as I,t as u,f as T,p as s,F as U,C as E,b as S,o as w,l as M}from"./index.BA0kIsUy.js";import{a as D,u as R}from"./http.BXiFSbaU.js";import{a as F,b as N}from"./index.BsO8iHDm.js";import{s as P}from"./index.Nv-_Bv1q.js";import{s as L}from"./index.BW2CRZ-U.js";import{h as j}from"./moment.BLMuvzoS.js";import{e as q,I as z,E as A}from"./EditorInstance.-FB_BG_o.js";import{_ as G}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./utils.CgJh8GwY.js";import"./index.BG3KSLm8.js";const O=B({__name:"ListaBlogs",props:{noEdit:{type:Boolean}},setup(b,{expose:t}){t();const f=b,e=E("modal-edit-blog-content"),a=S({contenido:null}),{data:g,isError:n,isPending:l,refetch:i}=D("blogs","listaBlogsData"),p=E("cm"),r=S(null),x=q(a.value),y=[{label:"Editar contenido",icon:"bi bi-pencil-square",command(){x.value?.commands.setContent(r.value?.contenido??"<p>Sin contenido</p>"),e.value?.showModal()}}],c=R("blogs","put",{onSuccess(){e.value?.close(),i(),a.value.contenido&&(a.value={})}}),C={props:f,modal:e,contenido:a,data:g,isError:n,isPending:l,refetch:i,cm:p,selectedItem:r,editor:x,items:y,updateBlog:c,onRowContextMenu:m=>{p.value?.show(m.originalEvent)},handleEdit:m=>{const{data:h,newValue:v,field:_}=m;h[_]!==v&&c.mutate({idblog:h.idblog,[_]:v})},handleUpdateContent:()=>{c.mutate({idblog:r.value?.idblog,contenido:a.value.contenido})},handleClose:()=>{a.value.contenido=null},get DataTable(){return N},get Column(){return F},get ContextMenu(){return P},get Textarea(){return L},get moment(){return j},Editor:A,ImageSelector:z};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),X={class:"modal-box"},H={class:"text-lg font-bold"},J={class:"w-full flex justify-end"},K=["disabled"];function Q(b,t,f,e,a,g){return w(),k(U,null,[d(e.ImageSelector,{"editor-instance":e.editor},null,8,["editor-instance"]),o("dialog",{ref:"modal-edit-blog-content",class:"modal modal-bottom sm:modal-middle",onClose:e.handleClose},[o("div",X,[t[1]||(t[1]=o("form",{method:"dialog"},[o("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},[o("i",{class:"bi bi-x text-xl"})])],-1)),o("h3",H,u(e.selectedItem?.titulo),1),o("form",{onSubmit:T(e.handleUpdateContent,["prevent"])},[d(e.Editor,{editor:e.editor},null,8,["editor"]),o("div",J,[o("button",{type:"submit",class:"btn btn-primary",disabled:e.contenido?.contenido===null||e.updateBlog.isPending.value},"Actualizar",8,K)])],32)]),t[2]||(t[2]=o("form",{method:"dialog",class:"modal-backdrop"},[o("button",null,"close")],-1))],544),d(e.ContextMenu,{ref:"cm",model:e.items},null,512),e.isError?I("",!0):(w(),V(e.DataTable,{key:0,loading:e.isPending,value:e.data?.response?.blogs??[],paginator:!0,rows:5,"edit-mode":e.props.noEdit?null:"cell",onCellEditComplete:e.handleEdit,onRowContextmenu:e.onRowContextMenu,"context-menu":"",contextMenuSelection:e.selectedItem,"onUpdate:contextMenuSelection":t[0]||(t[0]=n=>e.selectedItem=n)},{loading:s(()=>t[3]||(t[3]=[o("div",{class:"absolute top-0 left-0 h-full w-full z-30 select-none skeleton bg-base-300/60 backdrop-blur-[0.5px] rounded-btn"},null,-1)])),empty:s(()=>t[4]||(t[4]=[o("div",{class:"text-center font-bold"},"Sin datos.",-1)])),default:s(()=>[d(e.Column,{field:"titulo",header:"Titulo del blog"},{editor:s(({data:n,field:l})=>[d(e.Textarea,{modelValue:n[l],"onUpdate:modelValue":i=>n[l]=i},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),d(e.Column,{field:"estatus",header:"Estatus"},{body:s(({data:n,field:l})=>[M(u(n[l].toUpperCase()),1)]),_:1}),d(e.Column,{field:"createdAt",header:"Fecha de creaciÃ³n"},{body:s(({data:n,field:l})=>[M(u(e.moment(n[l]).locale("es-MX").format("L")),1)]),_:1})]),_:1},8,["loading","value","edit-mode","contextMenuSelection"]))],64)}const ce=G(O,[["render",Q]]);export{ce as default};
