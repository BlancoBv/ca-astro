import{d as w,u as y,b as p,h as C,i as S,o as c,c as b,k as m,f as N,g as k,n as F,F as M,a,w as I,j as A,q as B,s as P,e as T}from"./index.CXk2nglT.js";import{u as q,a as v}from"./http.BM7tfETz.js";import{a as E,s as R}from"./index.NsXB0CZk.js";import{s as U}from"./index.D_NW2bhJ.js";/* empty css                       */import{_ as g}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{h as Y}from"./moment.C5S46NFB.js";import"./utils.BFvbfp_u.js";import"./index.CWBm47LU.js";const j=w({__name:"ListaMinutas",props:{data:{},isPending:{type:Boolean},mutationDelete:{}},setup(u,{expose:t}){t();const i=u,e=y("cm"),o=p(null),s=p(!1),n=p([{label:"Eliminar",icon:"bi bi-trash-fill",command:()=>{i.mutationDelete.mutate({fileName:o.value?.fileName})}}]),r=f=>{e.value?.show(f.originalEvent)};C(()=>{s.value=!0}),S(()=>{s.value=!1});const d={props:i,cm:e,selectedItem:o,isMounted:s,items:n,onRowContextMenu:r,get DataTable(){return E},get Column(){return R},get ContextMenu(){return U}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),L={key:0,class:"skeleton h-96 w-full"};function V(u,t,i,e,o,s){return c(),b(M,null,[m(e.ContextMenu,{ref:"cm",model:e.items,onHide:t[0]||(t[0]=n=>e.selectedItem=null)},null,8,["model"]),e.isMounted?(c(),N(e.DataTable,{key:1,class:F({"skeleton select-none":e.props.isPending}),value:e.props.data,paginator:!0,rows:5,onRowContextmenu:e.onRowContextMenu,"context-menu":"",contextMenuSelection:e.selectedItem,"onUpdate:contextMenuSelection":t[1]||(t[1]=n=>e.selectedItem=n)},{default:k(()=>[m(e.Column,{field:"fileName",header:"Nombre del archivo",sortable:""}),m(e.Column,{field:"fechaCreacion",header:"Fecha de creación",sortable:""})]),_:1},8,["class","value","contextMenuSelection"])):(c(),b("div",L))],64)}const O=g(j,[["render",V]]),z=w({__name:"AddMinuta",setup(u,{expose:t}){t();const{data:i,isPending:e,refetch:o}=q("minutas","minutasData"),s=new Date(Date.now()),n=Y(s),r=P({fecha:n.format("YYYY-MM-DD")}),d=v("minutas","post",{sendAsFormData:!0,onSuccess(){const l=document.getElementById("input-add-file");l.value="",o()}}),f=v("minutas","delete",{onSuccess(){o()}}),h=l=>{const{files:D}=l.target;r.file=D[0]},x=T(()=>`MINUTA_CA;${r.fecha}.pdf`),_={data:i,isPending:e,refetch:o,date:s,m:n,body:r,send:d,deleteMinuta:f,handle:h,fileName:x,upload:()=>{const l=new FormData;l.append("file",r?.file??""),l.append("fileName",x.value),d.mutate(l)},ListaMinutas:O};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),G={class:"form-control w-full max-w-xs"},H={class:"form-control w-full max-w-xs"},J={class:"form-control w-full max-w-xs"},K=["value"];function Q(u,t,i,e,o,s){return c(),b(M,null,[a("form",{class:"grid grid-cols-2 lg:grid-cols-4 items-end gap-4 mb-4",onSubmit:B(e.upload,["prevent"])},[a("label",G,[t[1]||(t[1]=a("div",{class:"label"},[a("span",{class:"label-text"},"Selecciona una archivo")],-1)),a("input",{name:"imagen",type:"file",class:"file-input file-input-bordered w-full max-w-xs",accept:"application/pdf",onInput:e.handle,id:"input-add-file",required:""},null,32)]),a("label",H,[t[2]||(t[2]=a("div",{class:"label"},[a("span",{class:"label-text"},"Fecha")],-1)),I(a("input",{type:"date",class:"input input-bordered w-full max-w-xs","onUpdate:modelValue":t[0]||(t[0]=n=>e.body.fecha=n),required:""},null,512),[[A,e.body.fecha]])]),a("label",J,[t[3]||(t[3]=a("div",{class:"label"},[a("span",{class:"label-text"},"Nombre del archivo**")],-1)),a("input",{class:"input input-bordered w-full max-w-xs",value:e.fileName,required:"",readonly:"",disabled:""},null,8,K)]),t[4]||(t[4]=a("button",{class:"btn btn-primary",type:"submit"},"Añadir minuta",-1))],32),m(e.ListaMinutas,{data:e.data?.files??[],"is-pending":e.isPending,mutationDelete:e.deleteMinuta},null,8,["data","is-pending","mutationDelete"])],64)}const le=g(z,[["render",Q]]);export{le as default};
